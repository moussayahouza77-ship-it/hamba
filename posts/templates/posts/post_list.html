{% extends 'base.html' %}
{% block content %}
  <h2>Publications</h2>
  <div class="posts-grid">
    {% for post in posts %}
      <article class="card post-card">
        <div class="category-badge">{{ post.get_categorie_display }}</div>
        {% if post.thumbnail_url %}
          <div class="thumbnail"><a href="{% url 'posts:detail' post.pk %}"><img src="{{ post.thumbnail_url }}" alt="{{ post.titre }}" style="width:100%; height:160px; object-fit:cover; border-radius:8px;"/></a></div>
        {% elif post.image %}
          <div class="thumbnail"><a href="{% url 'posts:detail' post.pk %}"><img src="{{ post.image.url }}" alt="{{ post.titre }}" style="width:100%; height:160px; object-fit:cover; border-radius:8px;"/></a></div>
        {% endif %}
        <h3><a href="{% url 'posts:detail' post.pk %}">{{ post.titre }}</a></h3>
        <p class="meta">Par {{ post.auteur.username }} — {{ post.date_creation|date:'SHORT_DATE_FORMAT' }}</p>
        <p>{{ post.contenu|truncatechars:140 }}</p>
      </article>
    {% empty %}
      <p>Aucune publication.</p>
    {% endfor %}
  </div>
  {% if posts.has_other_pages %}
    <nav class="pagination">
      {% if posts.has_previous %}<a href="?page={{ posts.previous_page_number }}">← Précédent</a>{% endif %}
      <span>Page {{ posts.number }} / {{ posts.paginator.num_pages }}</span>
      {% if posts.has_next %}<a href="?page={{ posts.next_page_number }}">Suivant →</a>{% endif %}
    </nav>
  {% endif %}
{% endblock %}
